{% extends "base.html" %}

{% block title %}My Resume â€“ ResumeFit{% endblock %}

{% block content %}
<div class="py-4">

  <h1 class="mb-4">Upload / Update Resume</h1>

  <form method="post" enctype="multipart/form-data" class="mb-4">
    {{ form.hidden_tag() }}
    <div class="mb-3">
      {{ form.file.label(class="form-label") }}
      {{ form.file(class="form-control") }}
    </div>
    <button class="btn btn-primary">Upload</button>
    <a class="btn btn-secondary ms-2" href="{{ url_for('dashboard') }}">Back to Dashboard</a>
  </form>

  {% if latest %}
    {% set is_pdf = latest.original_filename.lower().endswith('.pdf') %}
    <div class="mt-2">
      {% if is_pdf %}
        <a class="btn btn-outline-light btn-sm"
          href="{{ url_for('resume_view', resume_id=latest.id) }}" target="_blank">
          View original PDF
        </a>
      {% else %}
        <a class="btn btn-outline-light btn-sm"
          href="{{ url_for('resume_view', resume_id=latest.id) }}" download>
          Download original file
        </a>
      {% endif %}
    </div>
  {% endif %}

  {% if latest %}
    <div class="card bg-black border-secondary mt-4">
      <div class="card-body">
        <h5 class="card-title">Extracted text preview</h5>
        <p class="text-muted mb-3">
          This is the text ResumeFit will use for matching.
        </p>
        <pre class="text-light mb-0" style="white-space: pre-wrap;">{{ latest.resume_text }}</pre>
      </div>
    </div>
  {% endif %}

</div>
{% endblock %}